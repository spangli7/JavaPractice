
CREATE TABLE vasarlas
(vasarlo INT,
nev VARCHAR(500));

INSERT INTO vasarlas (vasarlo, nev)
VALUES
(1, 'toll'),

(2, 'colostok'),
(2, 'HB ceruza'),
(2, 'HB ceruza'),
(2, 'colostok'),
(2, 'toll'),
(2, 'szatyor'),
(2, 'csavarkulcs'),
(2, 'doboz'),

(3, 'szatyor'),
(3, 'szatyor'),
(3, 'doboz'),
(3, 'doboz'),
(3, 'szatyor'),

(4, 'filctoll'),
(4, 'toll'),

(5, 'HB ceruza'),
(5, 'kefe'),
(5, 'csavarkulcs'),
(5, 'colostok'),
(5, 'doboz'),

(6, 'colostok'),
(6, 'colostok'),
(6, 'kefe'),
(6, 'ceruzaelem'),
(6, 'szatyor'),
(6, 'szatyor'),

(7, 'toll'),
(7, 'toll'),

(8, 'kefe'),
(8, 'csavarkulcs'),
(8, 'kefe'),
(8, 'colostok'),

(9, 'szatyor'),
(9, 'csavarkulcs'),
(9, 'kefe'),
(9, 'colostok'),
(9, 'ceruzaelem'),
(9, 'ceruzaelem'),
(9, 'ceruzaelem'),
(9, 'ceruzaelem'),

(10, 'colostok'),
(10, 'csavarkulcs'),
(10, 'HB ceruza'),

(11, 'doboz'),

(12, 'szatyor'),
(12, 'csavarkulcs'),
(12, 'HB ceruza'),
(12, 'szatyor'),

(13, 'HB ceruza'),

(14, 'csavarkulcs'),

(15, 'kefe'),
(15, 'colostok'),

(16, 'ceruzaelem'),

(17, 'szatyor'),

(18, 'toll'),
(18, 'csavarkulcs'),

(19, 'colostok'),
(19, 'szatyor'),

(20, 'toll'),
(20, 'HB ceruza'),
(20, 'doboz'),
(20, 'toll'),

(21, 'csavarkulcs'),

(22, 'filctoll'),

(23, 'toll'),
(23, 'doboz'),

(24, 'doboz'),
(24, 'doboz'),
(24, 'HB ceruza'),

(25, 'kefe'),

(26, 'HB ceruza'),
(26, 'filctoll'),
(26, 'szatyor'),
(26, 'colostok'),
(26, 'doboz'),
(26, 'ceruzaelem'),
(26, 'ceruzaelem'),
(26, 'szatyor'),
(26, 'szatyor'),
(26, 'HB ceruza'),

(27, 'doboz'),

(28, 'toll'),
(28, 'doboz'),
(28, 'szatyor'),

(29, 'HB ceruza'),
(29, 'colostok'),
(29, 'HB ceruza'),

(30, 'doboz'),
(30, 'filctoll'),

(31, 'toll'),

(32, 'HB ceruza'),
(32, 'filctoll'),

(33, 'toll'),
(33, 'HB ceruza'),
(33, 'ceruzaelem'),

(34, 'HB ceruza'),
(34, 'csavarkulcs'),
(34, 'csavarkulcs'),
(34, 'kefe'),

(35, 'szatyor'),
(35, 'doboz'),

(36, 'szatyor'),

(37, 'colostok'),
(37, 'csavarkulcs'),

(38, 'colostok'),
(38, 'csavarkulcs'),

(39, 'ceruzaelem'),
(39, 'doboz'),
(39, 'filctoll'),

(40, 'ceruzaelem'),

(41, 'csavarkulcs'),

(42, 'colostok'),
(42, 'kefe'),
(42, 'doboz'),
(42, 'toll'),
(42, 'filctoll'),

(43, 'kefe'),
(43, 'colostok'),
(43, 'csavarkulcs'),

(44, 'toll'),

(45, 'kefe'),
(45, 'doboz'),
(45, 'colostok'),

(46, 'szatyor'),
(46, 'kefe'),
(46, 'toll'),
(46, 'colostok'),
(46, 'toll'),

(47, 'filctoll'),
(47, 'csavarkulcs'),
(47, 'szatyor'),

(48, 'HB ceruza'),

(49, 'colostok'),
(49, 'HB ceruza'),

(50, 'colostok'),
(50, 'HB ceruza'),

(51, 'colostok'),

(52, 'kefe'),
(52, 'szatyor'),
(52, 'colostok'),

(53, 'HB ceruza'),
(53, 'ceruzaelem'),

(54, 'toll'),

(55, 'ceruzaelem'),

(56, 'kefe'),

(57, 'toll'),

(58, 'ceruzaelem'),
(58, 'filctoll'),

(59, 'filctoll'),
(59, 'szatyor'),
(59, 'colostok'),

(60, 'colostok'),

(61, 'ceruzaelem'),
(61, 'filctoll'),
(61, 'doboz'),
(61, 'colostok'),
(61, 'toll'),

(62, 'ceruzaelem'),

(63, 'kefe'),

(64, 'doboz'),
(64, 'HB ceruza'),

(65, 'szatyor'),
(65, 'colostok'),

(66, 'filctoll'),
(66, 'doboz'),

(67, 'colostok'),
(67, 'szatyor'),

(68, 'doboz'),

(69, 'ceruzaelem'),
(69, 'ceruzaelem'),

(70, 'kefe'),
(70, 'doboz'),
(70, 'colostok'),
(70, 'doboz'),
(70, 'kefe'),
(70, 'csavarkulcs'),

(71, 'HB ceruza'),
(71, 'csavarkulcs'),

(72, 'ceruzaelem'),

(73, 'filctoll'),
(73, 'toll'),
(73, 'colostok'),
(73, 'kefe'),
(73, 'filctoll'),

(74, 'filctoll'),
(74, 'doboz'),
(74, 'csavarkulcs'),
(74, 'kefe'),
(74, 'kefe'),

(75, 'csavarkulcs'),
(75, 'doboz'),
(75, 'HB ceruza'),
(75, 'kefe'),

(76, 'colostok'),
(76, 'szatyor'),
(76, 'colostok'),

(77, 'filctoll'),
(77, 'ceruzaelem'),
(77, 'HB ceruza'),
(77, 'filctoll'),
(77, 'HB ceruza'),

(78, 'ceruzaelem'),
(78, 'ceruzaelem'),

(79, 'HB ceruza'),
(79, 'csavarkulcs'),
(79, 'toll'),
(79, 'szatyor'),
(79, 'toll'),
(79, 'filctoll'),
(79, 'ceruzaelem'),

(80, 'csavarkulcs'),

(81, 'csavarkulcs'),
(81, 'ceruzaelem'),
(81, 'doboz'),
(81, 'doboz'),

(82, 'colostok'),

(83, 'toll'),
(83, 'HB ceruza'),

(84, 'kefe'),
(84, 'ceruzaelem'),

(85, 'HB ceruza'),

(86, 'ceruzaelem'),

(87, 'colostok'),
(87, 'doboz'),

(88, 'szatyor'),

(89, 'HB ceruza'),
(89, 'kefe'),
(89, 'doboz'),

(90, 'szatyor'),

(91, 'colostok'),

(92, 'csavarkulcs'),
(92, 'filctoll'),

(93, 'HB ceruza'),
(93, 'szatyor'),
(93, 'filctoll'),

(94, 'csavarkulcs'),
(94, 'kefe'),
(94, 'filctoll'),
(94, 'toll'),
(94, 'csavarkulcs'),
(94, 'doboz'),
(94, 'szatyor'),

(95, 'HB ceruza'),
(95, 'colostok'),
(95, 'filctoll'),

(96, 'doboz'),
(96, 'colostok'),
(96, 'colostok'),
(96, 'toll'),
(96, 'kefe'),
(96, 'kefe'),
(96, 'colostok'),
(96, 'csavarkulcs'),

(97, 'csavarkulcs'),
(97, 'toll'),

(98, 'ceruzaelem'),
(98, 'csavarkulcs'),
(98, 'szatyor'),
(98, 'toll'),

(99, 'toll'),
(99, 'filctoll'),

(100, 'kefe'),

(101, 'kefe'),
(101, 'toll'),
(101, 'doboz'),
(101, 'HB ceruza'),
(101, 'HB ceruza'),

(102, 'filctoll'),
(102, 'toll'),

(103, 'csavarkulcs'),

(104, 'colostok'),
(104, 'ceruzaelem'),

(105, 'HB ceruza'),

(106, 'toll'),
(106, 'colostok'),

(107, 'toll'),

(108, 'filctoll'),
(108, 'doboz'),

(109, 'toll'),
(109, 'doboz'),
(109, 'toll'),
(109, 'csavarkulcs'),
(109, 'csavarkulcs'),
(109, 'ceruzaelem'),

(110, 'colostok'),

(111, 'ceruzaelem'),
(111, 'ceruzaelem'),
(111, 'toll'),
(111, 'szatyor'),
(111, 'colostok'),

(112, 'colostok'),

(113, 'szatyor'),

(114, 'doboz'),
(114, 'filctoll'),
(114, 'colostok'),
(114, 'colostok'),
(114, 'doboz'),
(114, 'HB ceruza'),
(114, 'colostok'),

(115, 'doboz'),
(115, 'toll'),
(115, 'filctoll'),
(115, 'csavarkulcs'),
(115, 'csavarkulcs'),
(115, 'szatyor'),
(115, 'szatyor'),

(116, 'filctoll'),
(116, 'kefe'),

(117, 'kefe'),
(117, 'HB ceruza'),
(117, 'szatyor'),
(117, 'HB ceruza'),
(117, 'doboz'),

(118, 'doboz'),
(118, 'HB ceruza'),
(118, 'colostok'),
(118, 'toll'),
(118, 'szatyor'),
(118, 'ceruzaelem'),
(118, 'toll'),
(118, 'colostok'),
(118, 'szatyor'),
(118, 'toll'),

(119, 'HB ceruza'),
(119, 'toll'),
(119, 'ceruzaelem'),
(119, 'kefe'),
(119, 'HB ceruza'),
(119, 'kefe'),

(120, 'HB ceruza'),
(120, 'HB ceruza'),
(120, 'szatyor'),
(120, 'szatyor'),
(120, 'doboz'),
(120, 'kefe'),
(120, 'filctoll'),
(120, 'csavarkulcs'),
(120, 'kefe'),
(120, 'szatyor'),
(120, 'kefe'),

(121, 'ceruzaelem'),
(121, 'colostok'),
(121, 'filctoll'),

(122, 'ceruzaelem'),
(122, 'toll'),
(122, 'doboz'),
(122, 'toll'),
(122, 'szatyor'),

(123, 'HB ceruza'),
(123, 'csavarkulcs'),
(123, 'filctoll'),
(123, 'HB ceruza'),
(123, 'HB ceruza'),
(123, 'kefe'),
(123, 'toll'),
(123, 'HB ceruza'),

(124, 'doboz'),
(124, 'colostok'),
(124, 'HB ceruza'),
(124, 'ceruzaelem'),

(125, 'csavarkulcs'),
(125, 'toll'),
(125, 'csavarkulcs'),
(125, 'HB ceruza'),
(125, 'doboz'),
(125, 'szatyor'),

(126, 'kefe'),
(126, 'kefe'),
(126, 'csavarkulcs'),
(126, 'kefe'),
(126, 'csavarkulcs'),
(126, 'ceruzaelem'),
(126, 'toll'),
(126, 'colostok'),
(126, 'HB ceruza'),
(126, 'HB ceruza'),
(126, 'colostok'),
(126, 'toll'),
(126, 'szatyor'),
(126, 'csavarkulcs'),
(126, 'doboz'),

(127, 'szatyor'),
(127, 'szatyor'),
(127, 'doboz'),
(127, 'doboz'),
(127, 'szatyor'),

(128, 'filctoll'),
(128, 'toll'),
(128, 'HB ceruza'),
(128, 'kefe'),
(128, 'csavarkulcs'),
(128, 'colostok'),
(128, 'doboz'),

(129, 'colostok'),
(129, 'colostok'),
(129, 'kefe'),
(129, 'ceruzaelem'),
(129, 'szatyor'),
(129, 'szatyor'),
(129, 'toll'),
(129, 'toll'),

(130, 'kefe'),
(130, 'csavarkulcs'),
(130, 'kefe'),
(130, 'colostok'),

(131, 'szatyor'),
(131, 'csavarkulcs'),
(131, 'kefe'),
(131, 'colostok'),
(131, 'ceruzaelem'),
(131, 'ceruzaelem'),
(131, 'ceruzaelem'),
(131, 'ceruzaelem'),

(132, 'colostok'),
(132, 'csavarkulcs'),
(132, 'HB ceruza'),
(132, 'doboz'),
(132, 'szatyor'),
(132, 'csavarkulcs'),
(132, 'HB ceruza'),
(132, 'szatyor'),
(132, 'HB ceruza'),

(133, 'csavarkulcs'),
(133, 'kefe'),
(133, 'colostok'),
(133, 'ceruzaelem'),
(133, 'szatyor'),
(133, 'toll'),
(133, 'csavarkulcs'),
(133, 'colostok'),
(133, 'szatyor'),
(133, 'toll'),
(133, 'HB ceruza'),
(133, 'doboz'),
(133, 'toll');


CREATE TABLE shop_product
(id INT AUTO_INCREMENT PRIMARY KEY,
name VARCHAR(500));

INSERT INTO shop_product (name)
SELECT DISTINCT nev FROM vasarlas;

CREATE TABLE shop_purchase
(id INT,
product_id INT,
count INT,
PRIMARY KEY (id, product_id));

INSERT INTO shop_purchase
(id, product_id, count)
SELECT V.vasarlo, SP.id, COUNT(*) FROM vasarlas V
INNER JOIN shop_product SP ON SP.name = V.nev
GROUP BY V.vasarlo, SP.id;

DROP TABLE vasarlas;


SELECT * FROM shop_purchase SP
INNER JOIN shop_product SPR ON SPR.id = SP.product_id;